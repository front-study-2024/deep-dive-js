# 24장 클로저

- 클로저는 JS 고유의 개념이 아닌 함수를 일급객체로 취급하는 함수형 프로그래밍 언어에서 사용되는 특성이다.
- JS는 렉시컬 스코프를 따르는 프로그래밍 언어이다.

## 24.1 렉시컬 스코프

- 함수를 어디서 호출했는지가 아니라 함수를 어디서 정의했는지에 따라 상위 스코프를 결정한다.
- 외부 렉시컬 환경에 대한 참조를 통해 상위 렉시컬 환경과 연결 된다.
- 결국 함수의 상위 스코프는 렉시컬 환경의 외부 렉시컬 환경에 대한 참조에 저장할 값 결정

## 24.2 함수 객체의 내부 슬롯 [[Environment]]

- 함수는 자신의 내부 슬롯 [[Environment]] 에 자신이 정의 된 환경, 즉 상위 스코프의 참조를 저장한다.
- 함수 정의가 평가되어 함수객체를 생성하는 시점은 함수가 정의된 환경이며 이때 실행 중인 실행 컨텍스트는 상위 함수의 실행 컨텍스트 이다.
- 함수 객체의 내부 슬롯 [[Environment]]에 저장된 현재 실행 중인 실행 컨텍스트의 렉시컬 환경의 참조가 바로 상위 스코프

## 24.3 클로저와 렉시컬 환경

- 외부 함수보다 중첩함수가 더 오래 유지되는 경우, 중첩함수는 이미 생명주기가 종료된 외부함수의 변수를 참조할 수 있다. 이러한 중첩 함수를 클로저라고 부른다.
- 자바 스크립트의 모든 함수는 자신의 상위 스코프를 기억한다.


- 함수의 실행 컨텍스트가 종료되어 소멸되더라도 렉시컬 환경까지 소멸되는 것은 아니다.
- inner 함수가 outer의 렉시컬 환경을 참조하고 있으므로 가비지컬렉터 대상이 아니기 때문이다.
- 가비지컬렉터는 참조되고 있는 메모리 공간을 함부로 해제하지 않는다.
- 상위스코프의 어떤 식별자도 사용하지 않는 중첩 함수는 클로저가 아니다.
- 클로저는 중첩함수가 상위 스코프의 식별자를 참조하고 외부함수 보다 더 오래 유지되는 경우 한정
- 클로저에 의해 참조되는 상위 스코프의 변수를 자유 변수라고 부른다.

## 24.4 클로저의 활용

- 클로저는 상태를 안전하게 변경하고 유지하기 위해 사용된다.

```jsx
const counter = (function (){
	let num = 0;
	return {
		increase(){
			return ++num;
		},
		decrease(){
			return num > 0 ? --num : 0;
		}
	};
}());
```

- 함수를 통해 새로 반환된 함수는 독자적인 렉시컬 환경을 갖기에 공유되지 않는다.

## 24.5 캡슐화와 정보 은닉

- 캡슐화는 객체의 상태를 나타내는 프로퍼티와 프로퍼티를 참조하고 조작할 수 있는 동작인 메서드를 하나로 묶는것.
- 객체의 특정 프로퍼티나 메서드를 감추는 것을 정보 은닉
- let으로 선언한 경우 for문을 반복할때 마다 새로운 렉시컬 환경이 만들어 진다.
